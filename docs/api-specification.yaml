openapi: 3.0.3
info:
  title: XLHealth AIå¿ƒç†å’¨è¯¢ç³»ç»Ÿ API
  description: |
    XLHealth AIå¿ƒç†å’¨è¯¢ç³»ç»Ÿçš„RESTful APIæ¥å£æ–‡æ¡£

    ## è®¤è¯æ–¹å¼
    æœ¬APIä½¿ç”¨JWT Bearer Tokenè¿›è¡Œèº«ä»½è®¤è¯ï¼š
    ```
    Authorization: Bearer <your-jwt-token>
    ```

    ## é”™è¯¯ç ä½“ç³»
    | é”™è¯¯ç  | HTTPçŠ¶æ€ç  | æè¿° |
    |--------|------------|------|
    | 10001 | 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
    | 10002 | 401 | æœªæˆæƒè®¿é—® |
    | 10003 | 403 | æƒé™ä¸è¶³ |
    | 10004 | 404 | èµ„æºä¸å­˜åœ¨ |
    | 10005 | 409 | èµ„æºå†²çª |
    | 10006 | 422 | æ•°æ®éªŒè¯å¤±è´¥ |
    | 50001 | 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |
    | 50002 | 502 | å¤–éƒ¨æœåŠ¡é”™è¯¯ |
    | 50003 | 503 | æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ |

    ## åˆ†é¡µæ ¼å¼
    åˆ†é¡µæŸ¥è¯¢ç»Ÿä¸€ä½¿ç”¨ä»¥ä¸‹å‚æ•°ï¼š
    - `page`: é¡µç ï¼Œä»1å¼€å§‹
    - `size`: æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20ï¼Œæœ€å¤§100
    - `sort`: æ’åºå­—æ®µï¼Œæ ¼å¼ï¼š`field,direction`ï¼ˆå¦‚ï¼š`createdAt,desc`ï¼‰

    ## æ¥å£æ ‡è¯†è¯´æ˜
    - ğŸ”„ è¡¨ç¤ºå¹‚ç­‰æ€§æ¥å£ï¼ˆå¤šæ¬¡è°ƒç”¨ç»“æœç›¸åŒï¼‰
    - ğŸ” è¡¨ç¤ºæ•æ„Ÿæ¥å£ï¼ˆæ¶‰åŠç”¨æˆ·éšç§æˆ–é‡è¦æ“ä½œï¼‰
  version: 1.0.0
  contact:
    name: XLHealth å¼€å‘å›¢é˜Ÿ
    email: dev@xlhealth.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:8080
    description: æœ¬åœ°å¼€å‘ç¯å¢ƒ
  - url: https://api-dev.xlhealth.com
    description: å¼€å‘ç¯å¢ƒ
  - url: https://api.xlhealth.com
    description: ç”Ÿäº§ç¯å¢ƒ

security:
  - BearerAuth: []

paths:
  # ç”¨æˆ·è®¤è¯ç›¸å…³æ¥å£
  /api/v1/auth/register:
    post:
      tags:
        - ç”¨æˆ·è®¤è¯
      summary: ç”¨æˆ·æ³¨å†Œ
      description: æ–°ç”¨æˆ·æ³¨å†Œè´¦å·
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - email
                - password
                - nickname
              properties:
                username:
                  type: string
                  minLength: 3
                  maxLength: 50
                  pattern: "^[a-zA-Z0-9_]+$"
                  description: ç”¨æˆ·åï¼Œåªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿
                  example: user001
                email:
                  type: string
                  format: email
                  maxLength: 100
                  description: é‚®ç®±åœ°å€
                  example: user@example.com
                password:
                  type: string
                  minLength: 8
                  maxLength: 128
                  description: ğŸ” å¯†ç ï¼Œè‡³å°‘8ä½
                  example: password123
                nickname:
                  type: string
                  minLength: 1
                  maxLength: 50
                  description: ç”¨æˆ·æ˜µç§°
                  example: å°æ˜
            examples:
              normal:
                summary: æ­£å¸¸æ³¨å†Œ
                value:
                  username: user001
                  email: user@example.com
                  password: password123
                  nickname: å°æ˜
      responses:
        "201":
          description: æ³¨å†ŒæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  summary: æ³¨å†ŒæˆåŠŸ
                  value:
                    code: 0
                    message: æ³¨å†ŒæˆåŠŸ
                    data:
                      userId: 1001
                      username: user001
                      email: user@example.com
                      nickname: å°æ˜
                      createdAt: "2024-01-01T10:00:00Z"
        "400":
          $ref: "#/components/responses/BadRequest"
        "409":
          $ref: "#/components/responses/Conflict"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /api/v1/auth/login:
    post:
      tags:
        - ç”¨æˆ·è®¤è¯
      summary: ç”¨æˆ·ç™»å½•
      description: ğŸ” ç”¨æˆ·ç™»å½•è·å–è®¿é—®ä»¤ç‰Œ
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
              properties:
                username:
                  type: string
                  description: ç”¨æˆ·åæˆ–é‚®ç®±
                  example: user001
                password:
                  type: string
                  description: ğŸ” å¯†ç 
                  example: password123
      responses:
        "200":
          description: ç™»å½•æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  summary: ç™»å½•æˆåŠŸ
                  value:
                    code: 0
                    message: ç™»å½•æˆåŠŸ
                    data:
                      accessToken: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                      tokenType: Bearer
                      expiresIn: 86400
                      user:
                        id: 1001
                        username: user001
                        nickname: å°æ˜
                        avatarUrl: /avatars/user001.jpg
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /api/v1/auth/logout:
    post:
      tags:
        - ç”¨æˆ·è®¤è¯
      summary: ç”¨æˆ·ç™»å‡º
      description: ğŸ” ç”¨æˆ·ç™»å‡ºï¼Œä½¿å½“å‰ä»¤ç‰Œå¤±æ•ˆ
      responses:
        "200":
          description: ç™»å‡ºæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  summary: ç™»å‡ºæˆåŠŸ
                  value:
                    code: 0
                    message: ç™»å‡ºæˆåŠŸ
                    data: null
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"

  # ç”¨æˆ·ç®¡ç†ç›¸å…³æ¥å£
  /api/v1/users:
    post:
      tags:
        - ç”¨æˆ·ç®¡ç†
      summary: åˆ›å»ºç”¨æˆ·ï¼ˆç®¡ç†å‘˜ï¼‰
      description: ğŸ” ç®¡ç†å‘˜åˆ›å»ºæ–°ç”¨æˆ·
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - email
                - password
                - nickname
              properties:
                username:
                  type: string
                  minLength: 3
                  maxLength: 50
                  description: ç”¨æˆ·åï¼Œå¿…å¡«ï¼Œ3-50å­—ç¬¦
                  example: newuser
                email:
                  type: string
                  format: email
                  maxLength: 100
                  description: é‚®ç®±åœ°å€ï¼Œå¿…å¡«ï¼Œå”¯ä¸€
                  example: newuser@example.com
                password:
                  type: string
                  minLength: 8
                  maxLength: 128
                  description: ğŸ” å¯†ç ï¼Œå¿…å¡«ï¼Œè‡³å°‘8ä½
                  example: newpassword123
                nickname:
                  type: string
                  minLength: 1
                  maxLength: 50
                  description: ç”¨æˆ·æ˜µç§°ï¼Œå¿…å¡«
                  example: æ–°ç”¨æˆ·
                avatarUrl:
                  type: string
                  maxLength: 500
                  description: å¤´åƒURLï¼Œå¯é€‰
                  example: /avatars/newuser.jpg
                status:
                  type: string
                  enum: [ACTIVE, INACTIVE, BANNED]
                  description: è´¦æˆ·çŠ¶æ€ï¼Œå¯é€‰ï¼Œé»˜è®¤ACTIVE
                  example: ACTIVE
      responses:
        "201":
          description: ç”¨æˆ·åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  summary: åˆ›å»ºæˆåŠŸ
                  value:
                    code: 0
                    message: ç”¨æˆ·åˆ›å»ºæˆåŠŸ
                    data:
                      id: 1002
                      username: newuser
                      email: newuser@example.com
                      nickname: æ–°ç”¨æˆ·
                      avatarUrl: /avatars/newuser.jpg
                      status: ACTIVE
                      createdAt: "2024-01-01T10:00:00Z"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "409":
          $ref: "#/components/responses/Conflict"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /api/v1/users/profile:
    get:
      tags:
        - ç”¨æˆ·ç®¡ç†
      summary: è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
      description: ğŸ”„ è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯
      responses:
        "200":
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  summary: è·å–æˆåŠŸ
                  value:
                    code: 0
                    message: è·å–æˆåŠŸ
                    data:
                      id: 1001
                      username: user001
                      email: user@example.com
                      nickname: å°æ˜
                      avatarUrl: /avatars/user001.jpg
                      status: ACTIVE
                      createdAt: "2024-01-01T10:00:00Z"
                      lastLoginAt: "2024-01-01T15:30:00Z"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"

    put:
      tags:
        - ç”¨æˆ·ç®¡ç†
      summary: æ›´æ–°ç”¨æˆ·ä¿¡æ¯
      description: ğŸ” æ›´æ–°å½“å‰ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nickname:
                  type: string
                  minLength: 1
                  maxLength: 50
                  description: ç”¨æˆ·æ˜µç§°
                  example: æ–°æ˜µç§°
                avatarUrl:
                  type: string
                  maxLength: 500
                  description: å¤´åƒURL
                  example: /avatars/new-avatar.jpg
                email:
                  type: string
                  format: email
                  maxLength: 100
                  description: é‚®ç®±åœ°å€
                  example: newemail@example.com
      responses:
        "200":
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  summary: æ›´æ–°æˆåŠŸ
                  value:
                    code: 0
                    message: æ›´æ–°æˆåŠŸ
                    data:
                      id: 1001
                      username: user001
                      email: newemail@example.com
                      nickname: æ–°æ˜µç§°
                      avatarUrl: /avatars/new-avatar.jpg
                      updatedAt: "2024-01-01T16:00:00Z"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"
        "500":
          $ref: "#/components/responses/InternalServerError"

  # å¯¹è¯ç®¡ç†ç›¸å…³æ¥å£
  /api/v1/conversations:
    get:
      tags:
        - å¯¹è¯ç®¡ç†
      summary: è·å–å¯¹è¯åˆ—è¡¨
      description: ğŸ”„ è·å–å½“å‰ç”¨æˆ·çš„å¯¹è¯åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µï¼‰
      parameters:
        - name: page
          in: query
          description: é¡µç ï¼Œä»1å¼€å§‹
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: size
          in: query
          description: æ¯é¡µæ•°é‡
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: status
          in: query
          description: å¯¹è¯çŠ¶æ€ç­›é€‰
          schema:
            type: string
            enum: [ACTIVE, ARCHIVED, DELETED]
        - name: sort
          in: query
          description: æ’åºæ–¹å¼
          schema:
            type: string
            default: lastMessageAt,desc
            example: createdAt,desc
      responses:
        "200":
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          content:
                            type: array
                            items:
                              $ref: "#/components/schemas/Conversation"
                          pagination:
                            $ref: "#/components/schemas/Pagination"
              examples:
                success:
                  summary: è·å–æˆåŠŸ
                  value:
                    code: 0
                    message: è·å–æˆåŠŸ
                    data:
                      content:
                        - id: 2001
                          title: å…³äºç„¦è™‘çš„å’¨è¯¢
                          status: ACTIVE
                          createdAt: "2024-01-01T10:00:00Z"
                          lastMessageAt: "2024-01-01T15:30:00Z"
                          messageCount: 12
                        - id: 2002
                          title: ç¡çœ é—®é¢˜è®¨è®º
                          status: ACTIVE
                          createdAt: "2024-01-01T09:00:00Z"
                          lastMessageAt: "2024-01-01T14:20:00Z"
                          messageCount: 8
                      pagination:
                        page: 1
                        size: 20
                        total: 2
                        totalPages: 1
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"

    post:
      tags:
        - å¯¹è¯ç®¡ç†
      summary: åˆ›å»ºæ–°å¯¹è¯
      description: åˆ›å»ºä¸€ä¸ªæ–°çš„AIå¯¹è¯ä¼šè¯
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
              properties:
                title:
                  type: string
                  minLength: 1
                  maxLength: 200
                  description: å¯¹è¯æ ‡é¢˜ï¼Œå¿…å¡«
                  example: æ–°çš„å¿ƒç†å’¨è¯¢
                metadata:
                  type: object
                  description: å¯¹è¯å…ƒæ•°æ®ï¼Œå¯é€‰
                  example:
                    tags: ["anxiety", "stress"]
                    priority: "normal"
      responses:
        "201":
          description: åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  summary: åˆ›å»ºæˆåŠŸ
                  value:
                    code: 0
                    message: å¯¹è¯åˆ›å»ºæˆåŠŸ
                    data:
                      id: 2003
                      title: æ–°çš„å¿ƒç†å’¨è¯¢
                      status: ACTIVE
                      createdAt: "2024-01-01T16:00:00Z"
                      messageCount: 0
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalServerError"

  /api/v1/conversations/{conversationId}:
    get:
      tags:
        - å¯¹è¯ç®¡ç†
      summary: è·å–å¯¹è¯è¯¦æƒ…
      description: ğŸ”„ è·å–æŒ‡å®šå¯¹è¯çš„è¯¦ç»†ä¿¡æ¯
      parameters:
        - name: conversationId
          in: path
          required: true
          description: å¯¹è¯ID
          schema:
            type: integer
            format: int64
            example: 2001
      responses:
        "200":
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  summary: è·å–æˆåŠŸ
                  value:
                    code: 0
                    message: è·å–æˆåŠŸ
                    data:
                      id: 2001
                      title: å…³äºç„¦è™‘çš„å’¨è¯¢
                      status: ACTIVE
                      metadata:
                        tags: ["anxiety"]
                      createdAt: "2024-01-01T10:00:00Z"
                      updatedAt: "2024-01-01T15:30:00Z"
                      lastMessageAt: "2024-01-01T15:30:00Z"
                      messageCount: 12
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalServerError"

    put:
      tags:
        - å¯¹è¯ç®¡ç†
      summary: æ›´æ–°å¯¹è¯ä¿¡æ¯
      description: æ›´æ–°å¯¹è¯æ ‡é¢˜æˆ–çŠ¶æ€
      parameters:
        - name: conversationId
          in: path
          required: true
          description: å¯¹è¯ID
          schema:
            type: integer
            format: int64
            example: 2001
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                  minLength: 1
                  maxLength: 200
                  description: å¯¹è¯æ ‡é¢˜
                  example: æ›´æ–°åçš„æ ‡é¢˜
                status:
                  type: string
                  enum: [ACTIVE, ARCHIVED, DELETED]
                  description: å¯¹è¯çŠ¶æ€
                  example: ARCHIVED
                metadata:
                  type: object
                  description: å¯¹è¯å…ƒæ•°æ®
                  example:
                    tags: ["anxiety", "resolved"]
      responses:
        "200":
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  summary: æ›´æ–°æˆåŠŸ
                  value:
                    code: 0
                    message: æ›´æ–°æˆåŠŸ
                    data:
                      id: 2001
                      title: æ›´æ–°åçš„æ ‡é¢˜
                      status: ARCHIVED
                      updatedAt: "2024-01-01T16:30:00Z"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalServerError"

    delete:
      tags:
        - å¯¹è¯ç®¡ç†
      summary: åˆ é™¤å¯¹è¯
      description: ğŸ” åˆ é™¤æŒ‡å®šå¯¹è¯ï¼ˆè½¯åˆ é™¤ï¼‰
      parameters:
        - name: conversationId
          in: path
          required: true
          description: å¯¹è¯ID
          schema:
            type: integer
            format: int64
            example: 2001
      responses:
        "200":
          description: åˆ é™¤æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  summary: åˆ é™¤æˆåŠŸ
                  value:
                    code: 0
                    message: å¯¹è¯åˆ é™¤æˆåŠŸ
                    data: null
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalServerError"

  # æ¶ˆæ¯ç®¡ç†ç›¸å…³æ¥å£
  /api/v1/conversations/{conversationId}/messages:
    get:
      tags:
        - æ¶ˆæ¯ç®¡ç†
      summary: è·å–å¯¹è¯æ¶ˆæ¯
      description: ğŸ”„ è·å–æŒ‡å®šå¯¹è¯çš„æ¶ˆæ¯åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µï¼‰
      parameters:
        - name: conversationId
          in: path
          required: true
          description: å¯¹è¯ID
          schema:
            type: integer
            format: int64
            example: 2001
        - name: page
          in: query
          description: é¡µç ï¼Œä»1å¼€å§‹
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: size
          in: query
          description: æ¯é¡µæ•°é‡
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: messageType
          in: query
          description: æ¶ˆæ¯ç±»å‹ç­›é€‰
          schema:
            type: string
            enum: [USER, AI, SYSTEM]
        - name: sort
          in: query
          description: æ’åºæ–¹å¼
          schema:
            type: string
            default: createdAt,asc
            example: createdAt,desc
      responses:
        "200":
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          content:
                            type: array
                            items:
                              $ref: "#/components/schemas/Message"
                          pagination:
                            $ref: "#/components/schemas/Pagination"
              examples:
                success:
                  summary: è·å–æˆåŠŸ
                  value:
                    code: 0
                    message: è·å–æˆåŠŸ
                    data:
                      content:
                        - id: 3001
                          messageType: USER
                          content: æˆ‘æœ€è¿‘æ„Ÿåˆ°å¾ˆç„¦è™‘ï¼Œä¸çŸ¥é“è¯¥æ€ä¹ˆåŠ
                          createdAt: "2024-01-01T10:00:00Z"
                        - id: 3002
                          messageType: AI
                          content: æˆ‘ç†è§£æ‚¨çš„æ„Ÿå—ã€‚ç„¦è™‘æ˜¯å¾ˆå¸¸è§çš„æƒ…ç»ªååº”...
                          createdAt: "2024-01-01T10:01:00Z"
                      pagination:
                        page: 1
                        size: 50
                        total: 12
                        totalPages: 1
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalServerError"

    post:
      tags:
        - æ¶ˆæ¯ç®¡ç†
      summary: å‘é€æ¶ˆæ¯
      description: ğŸ” å‘æŒ‡å®šå¯¹è¯å‘é€æ¶ˆæ¯å¹¶è·å–AIå›å¤
      parameters:
        - name: conversationId
          in: path
          required: true
          description: å¯¹è¯ID
          schema:
            type: integer
            format: int64
            example: 2001
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                  minLength: 1
                  maxLength: 4000
                  description: ğŸ” æ¶ˆæ¯å†…å®¹ï¼Œå¿…å¡«
                  example: æˆ‘æœ€è¿‘å·¥ä½œå‹åŠ›å¾ˆå¤§ï¼Œç»å¸¸å¤±çœ 
                metadata:
                  type: object
                  description: æ¶ˆæ¯å…ƒæ•°æ®ï¼Œå¯é€‰
                  example:
                    sentiment: "negative"
                    urgency: "normal"
      responses:
        "201":
          description: æ¶ˆæ¯å‘é€æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  summary: å‘é€æˆåŠŸ
                  value:
                    code: 0
                    message: æ¶ˆæ¯å‘é€æˆåŠŸ
                    data:
                      userMessage:
                        id: 3003
                        messageType: USER
                        content: æˆ‘æœ€è¿‘å·¥ä½œå‹åŠ›å¾ˆå¤§ï¼Œç»å¸¸å¤±çœ 
                        createdAt: "2024-01-01T16:00:00Z"
                      aiMessage:
                        id: 3004
                        messageType: AI
                        content: å·¥ä½œå‹åŠ›å¯¼è‡´çš„å¤±çœ ç¡®å®å¾ˆå›°æ‰°ã€‚è®©æˆ‘ä»¬ä¸€èµ·æ¢è®¨ä¸€äº›ç¼“è§£å‹åŠ›å’Œæ”¹å–„ç¡çœ çš„æ–¹æ³•...
                        createdAt: "2024-01-01T16:00:30Z"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalServerError"
        "502":
          $ref: "#/components/responses/BadGateway"

  # ç³»ç»Ÿé…ç½®ç›¸å…³æ¥å£
  /api/v1/system/config:
    get:
      tags:
        - ç³»ç»Ÿç®¡ç†
      summary: è·å–ç³»ç»Ÿé…ç½®
      description: ğŸ”„ è·å–ç³»ç»Ÿé…ç½®ä¿¡æ¯ï¼ˆç®¡ç†å‘˜ï¼‰
      parameters:
        - name: configKey
          in: query
          description: é…ç½®é”®åç­›é€‰
          schema:
            type: string
            example: ai.model.name
      responses:
        "200":
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  summary: è·å–æˆåŠŸ
                  value:
                    code: 0
                    message: è·å–æˆåŠŸ
                    data:
                      - configKey: ai.model.name
                        configValue: gpt-3.5-turbo
                        description: AIæ¨¡å‹åç§°é…ç½®
                        configType: STRING
                      - configKey: system.maintenance.enabled
                        configValue: "false"
                        description: ç³»ç»Ÿç»´æŠ¤æ¨¡å¼å¼€å…³
                        configType: BOOLEAN
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "500":
          $ref: "#/components/responses/InternalServerError"

    put:
      tags:
        - ç³»ç»Ÿç®¡ç†
      summary: æ›´æ–°ç³»ç»Ÿé…ç½®
      description: ğŸ” æ›´æ–°ç³»ç»Ÿé…ç½®ï¼ˆç®¡ç†å‘˜ï¼‰
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - configKey
                - configValue
              properties:
                configKey:
                  type: string
                  maxLength: 100
                  description: é…ç½®é”®åï¼Œå¿…å¡«
                  example: ai.model.name
                configValue:
                  type: string
                  description: é…ç½®å€¼ï¼Œå¿…å¡«
                  example: gpt-4
                description:
                  type: string
                  maxLength: 500
                  description: é…ç½®æè¿°ï¼Œå¯é€‰
                  example: AIæ¨¡å‹åç§°é…ç½®
                configType:
                  type: string
                  enum: [STRING, NUMBER, BOOLEAN, JSON]
                  description: é…ç½®ç±»å‹ï¼Œå¯é€‰ï¼Œé»˜è®¤STRING
                  example: STRING
      responses:
        "200":
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse"
              examples:
                success:
                  summary: æ›´æ–°æˆåŠŸ
                  value:
                    code: 0
                    message: é…ç½®æ›´æ–°æˆåŠŸ
                    data:
                      configKey: ai.model.name
                      configValue: gpt-4
                      description: AIæ¨¡å‹åç§°é…ç½®
                      configType: STRING
                      updatedAt: "2024-01-01T16:30:00Z"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "500":
          $ref: "#/components/responses/InternalServerError"

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT Bearer Tokenè®¤è¯

  schemas:
    ApiResponse:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: integer
          description: å“åº”ç ï¼Œ0è¡¨ç¤ºæˆåŠŸï¼Œé0è¡¨ç¤ºé”™è¯¯
          example: 0
        message:
          type: string
          description: å“åº”æ¶ˆæ¯
          example: æ“ä½œæˆåŠŸ
        data:
          description: å“åº”æ•°æ®ï¼Œå¯ä»¥æ˜¯ä»»æ„ç±»å‹
        timestamp:
          type: string
          format: date-time
          description: å“åº”æ—¶é—´æˆ³
          example: "2024-01-01T10:00:00Z"

    ErrorResponse:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: integer
          description: é”™è¯¯ç 
          example: 10001
        message:
          type: string
          description: é”™è¯¯æ¶ˆæ¯
          example: è¯·æ±‚å‚æ•°é”™è¯¯
        details:
          type: string
          description: é”™è¯¯è¯¦æƒ…
          example: usernameå­—æ®µä¸èƒ½ä¸ºç©º
        timestamp:
          type: string
          format: date-time
          description: é”™è¯¯æ—¶é—´æˆ³
          example: "2024-01-01T10:00:00Z"
        path:
          type: string
          description: è¯·æ±‚è·¯å¾„
          example: /api/v1/users

    Pagination:
      type: object
      required:
        - page
        - size
        - total
        - totalPages
      properties:
        page:
          type: integer
          description: å½“å‰é¡µç 
          example: 1
        size:
          type: integer
          description: æ¯é¡µæ•°é‡
          example: 20
        total:
          type: integer
          format: int64
          description: æ€»è®°å½•æ•°
          example: 100
        totalPages:
          type: integer
          description: æ€»é¡µæ•°
          example: 5

    User:
      type: object
      required:
        - id
        - username
        - email
        - nickname
        - status
        - createdAt
      properties:
        id:
          type: integer
          format: int64
          description: ç”¨æˆ·ID
          example: 1001
        username:
          type: string
          description: ç”¨æˆ·å
          example: user001
        email:
          type: string
          format: email
          description: é‚®ç®±åœ°å€
          example: user@example.com
        nickname:
          type: string
          description: ç”¨æˆ·æ˜µç§°
          example: å°æ˜
        avatarUrl:
          type: string
          description: å¤´åƒURL
          example: /avatars/user001.jpg
        status:
          type: string
          enum: [ACTIVE, INACTIVE, BANNED]
          description: è´¦æˆ·çŠ¶æ€
          example: ACTIVE
        createdAt:
          type: string
          format: date-time
          description: åˆ›å»ºæ—¶é—´
          example: "2024-01-01T10:00:00Z"
        updatedAt:
          type: string
          format: date-time
          description: æ›´æ–°æ—¶é—´
          example: "2024-01-01T10:00:00Z"
        lastLoginAt:
          type: string
          format: date-time
          description: æœ€åç™»å½•æ—¶é—´
          example: "2024-01-01T15:30:00Z"

    Conversation:
      type: object
      required:
        - id
        - title
        - status
        - createdAt
      properties:
        id:
          type: integer
          format: int64
          description: å¯¹è¯ID
          example: 2001
        title:
          type: string
          description: å¯¹è¯æ ‡é¢˜
          example: å…³äºç„¦è™‘çš„å’¨è¯¢
        status:
          type: string
          enum: [ACTIVE, ARCHIVED, DELETED]
          description: å¯¹è¯çŠ¶æ€
          example: ACTIVE
        metadata:
          type: object
          description: å¯¹è¯å…ƒæ•°æ®
          example:
            tags: ["anxiety"]
        createdAt:
          type: string
          format: date-time
          description: åˆ›å»ºæ—¶é—´
          example: "2024-01-01T10:00:00Z"
        updatedAt:
          type: string
          format: date-time
          description: æ›´æ–°æ—¶é—´
          example: "2024-01-01T10:00:00Z"
        lastMessageAt:
          type: string
          format: date-time
          description: æœ€åæ¶ˆæ¯æ—¶é—´
          example: "2024-01-01T15:30:00Z"
        messageCount:
          type: integer
          description: æ¶ˆæ¯æ•°é‡
          example: 12

    Message:
      type: object
      required:
        - id
        - messageType
        - content
        - createdAt
      properties:
        id:
          type: integer
          format: int64
          description: æ¶ˆæ¯ID
          example: 3001
        messageType:
          type: string
          enum: [USER, AI, SYSTEM]
          description: æ¶ˆæ¯ç±»å‹
          example: USER
        content:
          type: string
          description: æ¶ˆæ¯å†…å®¹
          example: æˆ‘æœ€è¿‘æ„Ÿåˆ°å¾ˆç„¦è™‘
        metadata:
          type: object
          description: æ¶ˆæ¯å…ƒæ•°æ®
          example:
            sentiment: "negative"
        createdAt:
          type: string
          format: date-time
          description: åˆ›å»ºæ—¶é—´
          example: "2024-01-01T10:00:00Z"
        isDeleted:
          type: boolean
          description: æ˜¯å¦å·²åˆ é™¤
          example: false

  responses:
    BadRequest:
      description: è¯·æ±‚å‚æ•°é”™è¯¯
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            validation_error:
              summary: å‚æ•°éªŒè¯å¤±è´¥
              value:
                code: 10001
                message: è¯·æ±‚å‚æ•°é”™è¯¯
                details: usernameå­—æ®µä¸èƒ½ä¸ºç©º
                timestamp: "2024-01-01T10:00:00Z"
                path: /api/v1/users

    Unauthorized:
      description: æœªæˆæƒè®¿é—®
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            missing_token:
              summary: ç¼ºå°‘è®¿é—®ä»¤ç‰Œ
              value:
                code: 10002
                message: æœªæˆæƒè®¿é—®
                details: è¯·æä¾›æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œ
                timestamp: "2024-01-01T10:00:00Z"
                path: /api/v1/users/profile
            invalid_token:
              summary: æ— æ•ˆè®¿é—®ä»¤ç‰Œ
              value:
                code: 10002
                message: æœªæˆæƒè®¿é—®
                details: è®¿é—®ä»¤ç‰Œå·²è¿‡æœŸæˆ–æ— æ•ˆ
                timestamp: "2024-01-01T10:00:00Z"
                path: /api/v1/users/profile

    Forbidden:
      description: æƒé™ä¸è¶³
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            insufficient_permissions:
              summary: æƒé™ä¸è¶³
              value:
                code: 10003
                message: æƒé™ä¸è¶³
                details: æ‚¨æ²¡æœ‰è®¿é—®æ­¤èµ„æºçš„æƒé™
                timestamp: "2024-01-01T10:00:00Z"
                path: /api/v1/conversations/2001

    NotFound:
      description: èµ„æºä¸å­˜åœ¨
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            resource_not_found:
              summary: èµ„æºä¸å­˜åœ¨
              value:
                code: 10004
                message: èµ„æºä¸å­˜åœ¨
                details: æŒ‡å®šçš„å¯¹è¯ä¸å­˜åœ¨
                timestamp: "2024-01-01T10:00:00Z"
                path: /api/v1/conversations/9999

    Conflict:
      description: èµ„æºå†²çª
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            duplicate_resource:
              summary: èµ„æºå†²çª
              value:
                code: 10005
                message: èµ„æºå†²çª
                details: ç”¨æˆ·åå·²å­˜åœ¨
                timestamp: "2024-01-01T10:00:00Z"
                path: /api/v1/auth/register

    InternalServerError:
      description: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            server_error:
              summary: æœåŠ¡å™¨é”™è¯¯
              value:
                code: 50001
                message: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
                details: ç³»ç»Ÿæš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•
                timestamp: "2024-01-01T10:00:00Z"
                path: /api/v1/conversations

    BadGateway:
      description: å¤–éƒ¨æœåŠ¡é”™è¯¯
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            ai_service_error:
              summary: AIæœåŠ¡é”™è¯¯
              value:
                code: 50002
                message: å¤–éƒ¨æœåŠ¡é”™è¯¯
                details: AIæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•
                timestamp: "2024-01-01T10:00:00Z"
                path: /api/v1/conversations/2001/messages

tags:
  - name: ç”¨æˆ·è®¤è¯
    description: ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ç™»å‡ºç­‰è®¤è¯ç›¸å…³æ¥å£
  - name: ç”¨æˆ·ç®¡ç†
    description: ç”¨æˆ·ä¿¡æ¯ç®¡ç†ç›¸å…³æ¥å£
  - name: å¯¹è¯ç®¡ç†
    description: AIå¯¹è¯ä¼šè¯ç®¡ç†ç›¸å…³æ¥å£
  - name: æ¶ˆæ¯ç®¡ç†
    description: å¯¹è¯æ¶ˆæ¯ç®¡ç†ç›¸å…³æ¥å£
  - name: ç³»ç»Ÿç®¡ç†
    description: ç³»ç»Ÿé…ç½®å’Œç®¡ç†ç›¸å…³æ¥å£
